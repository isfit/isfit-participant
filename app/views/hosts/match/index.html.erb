
<% content_for :breadcrumbs do %>
    <li><%= link_to 'Dashboard', dashboard_path %></li>
    <li><%= link_to 'Hosts',hosts_path %></li>
    <li class="active">Host matching</li>
<% end %>
<h2 class="col-md-12">Select participant</h2>
<%= form_tag '', method: :get do |f| %>
    <div class="form-group col-md-12">
      <%= text_field_tag :search, params[:search], {placeholder: 'Who are you looking for?', class: 'form-control'} %>
      </div>
    <div class="form-group col-md-6">
      <%= select_tag :only_checked_in, options_for_select([['Show all','0'],['Show only checked in','1']],params[:only_checked_in] || 0), :class => 'form-control' %>
    </div>
    <div class="form-group col-md-6">
      <%= collection_select(:country, :country_id, Country.all, :id, :name, {:prompt => 'Please select country (Optional)', :selected => selected_country},{  :class => 'form-control'}) %>
    </div>
    <% if @match_now %>
        <input type="hidden" name="match_now" value="true" />
    <% end %>
    <div class="form-group col-md-12">
      <%= submit_tag 'Filter', class: 'btn btn-primary' %>
    </div>
<% end %>
<table id="participants" class="table">
  <tr>
    <th>Full name</th>
    <th>Gender</th>
    <th>Country</th>
    <th>Gender preference</th>
    <th>Smoker</th>
    <th>Other preferences</th>
  </tr>

  <% @participants.each do |a| %>
      <% puts a.user_id.to_s + " " + a.user.full_name + '\n'  %>
      <tr>
        <td><%= link_to a.user.full_name, a %></td>
        <td><%= int_to_gender(a.user.profile.gender)%></td>
        <td><%= a.user.profile ? a.user.profile.country.name : 'N/A' %></td>
        <td><%= gender_pref_to_friendly(a.user.profile.host_gender_preference) %></td>
        <td><%= bool_to_friendly(a.user.profile.smoke) %></td>
        <td><%= a.user.profile.other_host_preferences %></td>
          </tr>
      <tr>
          <% if @match_now %>
            <td style="border-top: 0px"><%= link_to 'Match', {:controller => 'participants',:action => 'apply_match', :host_id => @host.id, :participant_id => a.id} , {:method => :put, :confirm => "Do you want to match the current host with this participant?", :class => 'btn btn-success'} %></td>
        <% else %>
            <td style="border-top: 0px"><%= link_to 'Select', participant_match_host_path(a.id), :class => 'btn btn-success' %></td>
        <% end %>
      </tr>
  <% end %>
</table>

<%= will_paginate(@participants, renderer: BootstrapPagination::Rails) %>
